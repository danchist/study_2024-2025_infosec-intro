---
## Front matter
lang: ru-RU
title: Индивидуальный проект - Этап 5
subtitle: Основы информационной безопасности
author:
  - Чистов Д. М.
institute:
  - Российский университет дружбы народов, Москва, Россия
  - Объединённый институт ядерных исследований, Дубна, Россия
date: 10 мая 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель работы

Получение навыков пользование Burp Suite.

## Введение

Burp Suite - инструмент для тестирования безопасности веб-приложений, позволяющий множеством функций перехватывать, анализировать, модифицировать разные HTTP-запросы между клиентом и сервером.

# Выполнение лабораторной работы

Запускаю Burp Suite, прохожу через пару диалоговых окон, где спрашивают, как будет устроен проект, над которым мы будем работать.

![Инициализация Burp Suite](image/IMG_001.jpg){#fig:001 width=70%}

## Выполнение лабораторной работы

Открываю встроенный в Burp Suite браузер и открываю в нём DVWA - всё как обычно.

![DVWA через встроенный браузер](image/IMG_002.jpg){#fig:002 width=70%}

## Выполнение лабораторной работы

Перед работой надо запустить apache2 и mysql, буду тестировать Burp Suite на dvwa - брут форс пароля, как в этапе про Hydra, только в этот раз у DVWA будет уровень защиты "Высокий".

![Высокий уровень защиты DVWA](image/IMG_003.jpg){#fig:003 width=70%}

## Выполнение лабораторной работы

Перехожу на страничку Brute Force DVWA, там есть кнопку view source, которая позволяет посмотреть код данной странички. Такая страничка различается на разных уровнях сложности - на уровне сложности High появляется user_token, который совсем чуток усложняет брут форс.

![Код странички входа на сложности High](image/IMG_004.jpg){#fig:004 width=70%}

## О user_token

При каждом обновлении страницы меняется и user_token (а страница будет много обновляться при множестве неудачных попыток брут форса), сервер в свою очередь не пропускает реквесты, у которых уже устарел user_token, т.е. взломщику нужно придумать способ, как этот user_token получать автоматически при каждой попытке брут форса.

## Выполнение лабораторной работы

Идём далее, с помощью Burp Suite мы можем автоматизировать процесс нахождения user_token (он вшит в страничку). Захожу в настройки и во вкладке Sessions создаю новое правило.

![Новое правило в Burp Suite](image/IMG_005.jpg){#fig:005 width=70%}

## Выполнение лабораторной работы

В новом правиле мы добавляем новое "макро действие", и затем настраиваем его - открывается Macro Recorder, где мы выбираем наш последний реквест - попытку входа в DVWA, оттуда мы можем посмотреть на наш реквест в виде кода и найти строчки с user_token.

![Новое макро действие в Burp Suite](image/IMG_006.jpg){#fig:006 width=70%}

## Выполнение лабораторной работы

В открытом коде реквеста находим нужный параметр, за которым мы будем следить и запоминать - user_token.

![Отслеживание параметра user_token в каждом реквесте](image/IMG_007.jpg){#fig:007 width=70%}

## Выполнение лабораторной работы

Сохраняем наше макро действие, ставим галочку "Tolerate URL mismatch when matching parameters (Use for URL-agnostic CRSF tokens)" - тут написано ставить, если мы имеем дело с юзер токенами.

![Сохранение макро действия](image/IMG_008.jpg){#fig:008 width=70%}

## Выполнение лабораторной работы

Возвращаемся в настройку правила, выставляем галочки так, чтобы это правило применялось исключительно к инструменту Intruder - им мы будем пользоваться для брут форса приложения.

![Сохранение нового правила](image/IMG_009.jpg){#fig:009 width=70%}

## Выполнение лабораторной работы

Начнём. Включаем Intercepter - перехватываем реквест с попыткой входа.

![Перехват реквеста с попыткой входа](image/IMG_010.jpg){#fig:010 width=70%}

## Выполнение лабораторной работы

Открываем вкладку HTTP-history и находим перехваченный реквест, нажимаем на него правой кнопкой и "Send to Intruder" (отправляем в инструмент взломащика), а затем "Add to scope".

![Отправляем реквест взломщику](image/IMG_011.jpg){#fig:011 width=70%}

## Выполнение лабораторной работы

Теперь открываем вкладку "Intruder" - находим посланный нами реквест, выбираем тип атаки "Cluster Bomb" - стандартный брут форс - постоянный перебор и отправка реквестов, также выделяем значения параметра username и нажимаем "Add $", так мы выделили первый параметр, который мы будем перебирать и посылать каждый реквест - аналогично делаем и со значением переменной password.

![Выделяем переменные для подбора пароля и логина](image/IMG_012.jpg){#fig:012 width=70%}

## Выполнение лабораторной работы

Открываем Payloads (тут мы настраиваем переменные, которые будем перебирать, т.к. мы перебираем логин и пароль, у нас их 2). Первый пейлоуд - выбираем, что будем перебирать: значения из файла, выбираем файл - в Kali есть стандартный список дефолтных логинов и паролей - они лежат в /usr/share/wordlists/metasploit. Для списка логинов выбираем http_default_users.txt.

![Выбираем файл для перебора логинов](image/IMG_013.jpg){#fig:013 width=70%}

## Выполнение лабораторной работы

Аналогично делаем и для второго пейлоуда - перебор паролей - http_default_pass.txt.

![Выбираем файл для перебора паролей - http_default_pass.txt](image/IMG_014.jpg){#fig:014 width=70%}

## Выполнение лабораторной работы

Открываем настройки Intruder, для наглядности добавим слово, за которым мы будем следить, и если оно появляется в коде странички - то мы ставим нашему реквесту флажок. Выбираем слово "incorrect", тогда мы обратим внимание, что при правильном наборе логина и пароля флажка не будет.

![Ставим маркер на слово incorrect](image/IMG_015.jpg){#fig:015 width=70%}

## Выполнение лабораторной работы

Запускаем нашего атакующего - начинаем брут форс. Наглядно видно, как посылается много реквестов. На фото я также их отсортировал по длине кода в страчничке. Обратим внимание, что тут в первой строке при логине admin и пароле password мало того, нету флажка Incorrect, так ещё и длина кода страничке значительно отличается от всех остальных - явно что-то особенное случилось при таком наборе логина и пароля. Обычно, взломщик в таком случае сам попробует такой набор логина и пароля.

![Задокументированная брут форс атака](image/IMG_016.jpg){#fig:016 width=70%}

## Выполнение лабораторной работы

Вставляем такую комбинацию логина и пароля в страчнику входа и видим, что мы успешно прорвались в чужок аккаунт.

![Атака прошла успешно](image/IMG_017.jpg){#fig:017 width=70%}

# Выводы

При выполнении данной работы я успешно получил навыки работы с Burp Suite.

# Список литературы

[Индивидуальный проект](https://esystem.rudn.ru/mod/page/view.php?id=1220137#citeproc_bib_item_1)

[Brute Force DVWA разной сложности с использованием Burp Suite (На английском)](https://www.youtube.com/watch?v=pSBD9cgwgk0)

